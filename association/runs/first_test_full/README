Run args: Namespace(association_run_name='first_test_full', imputation_run_name='first_pass', regions='2:1-,3:1-', sample_filtering_run_name='height')Adding participant ID index and sex covariate to df. File: /projects/ps-gymreklab/jmargoli/ukbiobank/microarray/ukb46122_cal_chr1_v2_s488282.fam, cols: (0, 4)
Adding PC covariates 1-40. File: /projects/ps-gymreklab/jmargoli/ukbiobank/misc_data/EGA/ukb_sqc_v2.txt, cols: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]. Participants in same order as previous file.
Adding height phenotype and sampling visit. File: /projects/ps-gymreklab/jmargoli/ukbiobank/main_dataset/extracted_data/height.txt. Only reporting first height measurement taken even if there were multiple at different vists
Adding direct, total and indirect_bilirubin phenotypes. File: /projects/ps-gymreklab/jmargoli/ukbiobank/main_dataset/extracted_data/bilirubin.csv. Only recording first visit's value, regardless of whether it is not present and/or there is a follow up visit value. NaNing total values where direct is missing (or visa versa) as an overly conservative approach to making sure we have clean data as a I don't know why we'd be missing one but not both. This effectively cuts down 70k total_bilirubin measurements which don't have direct counterparts. The indirect phenotype is simply calculated as total - direct.
Removing samples which are missing height or bilirubin values so we can run both together. This cuts down on ~100k ppts who have height but not bilirubin. Will do this more intelligently later.
Subsetting to samples from file /projects/ps-gymreklab/jmargoli/ukbiobank/sample_qc/runs/height/combined_unrelated.sample. Left with ~275k samples
Using str calls from imputed run first_pass
Filtering calls whose phased genotype probability as estimated by Beagle is less than 0.9. Number filtered this way is the #samples_GP_filtered column in results.txtConvert and collapse sequence alleles to length alleles. Removing length alleles with 4 or fewer occurrences. For a single association, removing samples with any removed alleles. Then convert sample genotypes to their average allele length. #filtered_rare_alleles in results.txt is the number of length alleles with between 1 and 4 copies in all samples which were filtered due to rarity.
Performing linear association against listed covariates and average allele length
Running associations with 278224 samples
